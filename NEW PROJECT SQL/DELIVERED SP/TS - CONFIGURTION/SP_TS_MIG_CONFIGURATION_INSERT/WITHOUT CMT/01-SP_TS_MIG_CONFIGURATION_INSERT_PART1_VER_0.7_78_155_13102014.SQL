DROP PROCEDURE IF EXISTS SP_TS_MIG_CONFIGURATION_INSERT_PART1;
CREATE PROCEDURE SP_TS_MIG_CONFIGURATION_INSERT_PART1(
IN SOURCESCHEMA VARCHAR(40),
IN DESTINATIONSCHEMA VARCHAR(40),
IN MIGUSERSTAMP VARCHAR(50))
BEGIN
	DECLARE START_TIME TIME;
	DECLARE END_TIME TIME;
	DECLARE DURATION TIME;
	DECLARE MAX_ID INT;
	DECLARE EXIT HANDLER FOR SQLEXCEPTION
	BEGIN
		ROLLBACK;
	END;
	START TRANSACTION;
	SET FOREIGN_KEY_CHECKS=0;
	SET @LOGIN_ID=(SELECT CONCAT('SELECT ULD_ID INTO @ULDID FROM ',DESTINATIONSCHEMA,'.USER_LOGIN_DETAILS WHERE ULD_LOGINID=','"',MIGUSERSTAMP,'"'));
	PREPARE LOGINID_STMT FROM @LOGIN_ID;
	EXECUTE LOGINID_STMT;
	SET @DROP_TEMP_CONFIG_SQL_FORMAT=(SELECT CONCAT('DROP TABLE IF EXISTS ',DESTINATIONSCHEMA,'.TEMP_CONFIG_SQL_FORMAT'));
	PREPARE DROP_TEMP_CONFIG_SQL_FORMAT_STMT FROM @DROP_TEMP_CONFIG_SQL_FORMAT;
	EXECUTE DROP_TEMP_CONFIG_SQL_FORMAT_STMT;
	SET @CREATE_TEMP_CONFIG_SQL_FORMAT=(SELECT CONCAT('CREATE TABLE ',DESTINATIONSCHEMA,'.TEMP_CONFIG_SQL_FORMAT (
	ID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
	CNP_ID VARCHAR(50) NULL,
	CNP_DATA VARCHAR(255) NULL,
	CGN_ID VARCHAR(50) NULL,
	CGN_DATA VARCHAR(255) NULL,
	DATA TEXT NULL,
	TP_ID VARCHAR(50) NULL,
	TP_TYPE VARCHAR(255) NULL,
	TTIP_ID VARCHAR(50) NULL,
	TTIP_DATA VARCHAR(255) NULL,
	EMC_CODE VARCHAR(50) NULL,
	EMC_DATA TEXT NULL,
	PD_DATA VARCHAR(255) NULL,
	PD_DESCRIPTION TEXT NULL,
	PD_ID VARCHAR(20) NULL,
	PC_ID VARCHAR(20) NULL,
	PS_REC_VER VARCHAR(20) NULL,
	PS_START_DATE DATE NULL,
	PS_END_DATE DATE NULL,
	USER_STAMP VARCHAR(100) NULL,
	`TIMESTAMP` TIMESTAMP NULL)'));
	PREPARE CREATE_TEMP_CONFIG_SQL_FORMAT_STMT FROM @CREATE_TEMP_CONFIG_SQL_FORMAT;
	EXECUTE CREATE_TEMP_CONFIG_SQL_FORMAT_STMT;
	SET @INSERT_TEMP_CONFIG_SQL_FORMAT=(SELECT CONCAT('INSERT INTO  ',DESTINATIONSCHEMA,'.TEMP_CONFIG_SQL_FORMAT (CNP_ID,CNP_DATA,CGN_ID,CGN_DATA,DATA,TP_ID,TP_TYPE,TTIP_ID,TTIP_DATA,EMC_CODE,EMC_DATA,PD_DATA,PD_DESCRIPTION,PD_ID,PC_ID,PS_REC_VER,PS_START_DATE,PS_END_DATE,USER_STAMP,TIMESTAMP) 
	(SELECT CNP_ID,CNP_DATA,CGN_ID,CGN_DATA,DATA,TP_ID,TP_TYPE,TTIP_ID,TTIP_DATA,EMC_CODE,EMC_DATA,PD_DATA,PD_DESCRIPTION,PD_ID,PC_ID,PS_REC_VER,PS_START_DATE,PS_END_DATE,USER_STAMP,TIMESTAMP FROM ',SOURCESCHEMA,'.CONFIG_SQL_FORMAT)'));
	PREPARE INSERT_TEMP_CONFIG_SQL_FORMAT_STMT FROM @INSERT_TEMP_CONFIG_SQL_FORMAT;
	EXECUTE INSERT_TEMP_CONFIG_SQL_FORMAT_STMT;
	SET START_TIME = (SELECT CURTIME());
	SET @TRUNCATE_TICKLER_PROFILE=(SELECT CONCAT('TRUNCATE ',DESTINATIONSCHEMA,'.TICKLER_PROFILE'));
	PREPARE TRUNCATE_TICKLER_PROFILE_STMT FROM @TRUNCATE_TICKLER_PROFILE;
	EXECUTE TRUNCATE_TICKLER_PROFILE_STMT;
	SET @INSERT_TICKLER_PROFILE=(SELECT CONCAT('INSERT INTO ',DESTINATIONSCHEMA,'.TICKLER_PROFILE (TP_TYPE) (SELECT TP_TYPE FROM ',DESTINATIONSCHEMA,'.TEMP_CONFIG_SQL_FORMAT WHERE TP_TYPE IS NOT NULL)'));
	PREPARE INSERT_TICKLER_PROFILE_STMT FROM @INSERT_TICKLER_PROFILE;
	EXECUTE INSERT_TICKLER_PROFILE_STMT;
	SET @TICKLERPROFILE_MAX_ID = (SELECT CONCAT('SELECT MAX(TP_ID) INTO @TICKLER_PROFILE_MAX_ID FROM ',DESTINATIONSCHEMA,'.TICKLER_PROFILE'));
	PREPARE TICKLER_PROFILE_MAX_ID_STMT FROM @TICKLERPROFILE_MAX_ID;
	EXECUTE TICKLER_PROFILE_MAX_ID_STMT;
	SET MAX_ID=@TICKLER_PROFILE_MAX_ID;
	IF (MAX_ID IS NOT NULL) THEN    
		SET @ALTER_TICKLER_PROFILE=(SELECT CONCAT('ALTER TABLE ',DESTINATIONSCHEMA,'.TICKLER_PROFILE AUTO_INCREMENT=',MAX_ID));
		PREPARE ALTER_TICKLER_PROFILE_STMT FROM @ALTER_TICKLER_PROFILE;
		EXECUTE ALTER_TICKLER_PROFILE_STMT;
	END IF;
	SET END_TIME = (SELECT CURTIME());
	SET DURATION=(SELECT TIMEDIFF(END_TIME,START_TIME));
	SET @COUNT_TICKLERCONFIGURATIONSQLFORMAT=(SELECT CONCAT('SELECT COUNT(TP_TYPE) INTO @COUNT_TICKLER_CONFIGURATION_SQL_FORMAT FROM ',DESTINATIONSCHEMA,'.TEMP_CONFIG_SQL_FORMAT WHERE TP_TYPE IS NOT NULL'));
	PREPARE COUNT_TICKLERCONFIGURATIONSQLFORMAT_STMT FROM @COUNT_TICKLERCONFIGURATIONSQLFORMAT;
	EXECUTE COUNT_TICKLERCONFIGURATIONSQLFORMAT_STMT;
	SET @COUNT_SPLITINGTICKLER_PROFILE=(SELECT CONCAT('SELECT COUNT(*) INTO @COUNT_SPLITING_TICKLER_PROFILE FROM ',DESTINATIONSCHEMA,'.TICKLER_PROFILE'));
	PREPARE COUNT_SPLITINGCOUNT_TICKLER_PROFILE_STMT FROM @COUNT_SPLITINGTICKLER_PROFILE;
	EXECUTE COUNT_SPLITINGCOUNT_TICKLER_PROFILE_STMT;
	SET @REJECTION_COUNT=(@COUNT_TICKLER_CONFIGURATION_SQL_FORMAT-@COUNT_SPLITING_TICKLER_PROFILE);
	SET @POSTAPID= (SELECT POSTAP_ID FROM POST_AUDIT_PROFILE WHERE POSTAP_DATA='TICKLER_PROFILE');
	SET @PREASPID = (SELECT PREASP_ID FROM PRE_AUDIT_SUB_PROFILE WHERE PREASP_DATA='TICKLER_PROFILE');
	SET @PREAMPID = (SELECT PREAMP_ID FROM PRE_AUDIT_MAIN_PROFILE WHERE PREAMP_DATA='CONFIGURATION');
	SET @DUR=DURATION;
	UPDATE PRE_AUDIT_SUB_PROFILE SET PREASP_NO_OF_REC=@COUNT_TICKLER_CONFIGURATION_SQL_FORMAT WHERE PREASP_DATA='TICKLER_PROFILE';    
	INSERT INTO POST_AUDIT_HISTORY(POSTAP_ID,POSTAH_NO_OF_REC,PREASP_ID,PREAMP_ID,POSTAH_DURATION,POSTAH_NO_OF_REJ,ULD_ID) VALUES
	(@POSTAPID,@COUNT_SPLITING_TICKLER_PROFILE,@PREASPID,@PREAMPID,@DUR,@REJECTION_COUNT,@ULDID);
	SET START_TIME = (SELECT CURTIME());
	SET @TRUNCATE_TICKLER_TABID_PROFILE=(SELECT CONCAT('TRUNCATE ',DESTINATIONSCHEMA,'.TICKLER_TABID_PROFILE'));
	PREPARE TRUNCATE_TICKLER_TABID_PROFILE_STMT FROM @TRUNCATE_TICKLER_TABID_PROFILE;
	EXECUTE TRUNCATE_TICKLER_TABID_PROFILE_STMT;
	SET @INSERT_TICKLER_TABLE_PROFILE=(SELECT CONCAT('INSERT INTO ',DESTINATIONSCHEMA,'. TICKLER_TABID_PROFILE(TTIP_DATA) (SELECT TTIP_DATA FROM ',DESTINATIONSCHEMA,'.TEMP_CONFIG_SQL_FORMAT WHERE TTIP_DATA IS NOT NULL)'));
	PREPARE INSERT_TICKLER_TABLE_PROFILE_STMT FROM @INSERT_TICKLER_TABLE_PROFILE;
	EXECUTE INSERT_TICKLER_TABLE_PROFILE_STMT;
	SET @TICKLERTABIDPROFILE_MAX_ID = (SELECT CONCAT('SELECT MAX(TTIP_ID) INTO @TICKLER_TABID_PROFILE_MAX_ID FROM ',DESTINATIONSCHEMA,'.TICKLER_TABID_PROFILE'));
	PREPARE TICKLER_TABID_PROFILE_MAX_ID_STMT FROM @TICKLERTABIDPROFILE_MAX_ID;
	EXECUTE TICKLER_TABID_PROFILE_MAX_ID_STMT;
	SET MAX_ID=@TICKLER_TABID_PROFILE_MAX_ID;
	IF (MAX_ID IS NOT NULL) THEN    
		SET @ALTER_TICKLER_TABID_PROFILE =(SELECT CONCAT('ALTER TABLE ',DESTINATIONSCHEMA,'.TICKLER_TABID_PROFILE AUTO_INCREMENT=',MAX_ID));
		PREPARE ALTER_TICKLER_TABID_PROFILE_STMT FROM @ALTER_TICKLER_TABID_PROFILE;
		EXECUTE ALTER_TICKLER_TABID_PROFILE_STMT;
	END IF;
	SET END_TIME = (SELECT CURTIME());
	SET DURATION=(SELECT TIMEDIFF(END_TIME,START_TIME));    
	SET @COUNT_TICKLERTABIDCONFIGURATIONSQLFORMAT=(SELECT CONCAT('SELECT COUNT(TTIP_DATA) INTO @COUNT_TICKLER_TABID_CONFIGURATION_SQL_FORMAT FROM ',DESTINATIONSCHEMA,'.TEMP_CONFIG_SQL_FORMAT WHERE TTIP_DATA IS NOT NULL'));
	PREPARE COUNT_TICKLERTABIDCONFIGURATIONSQLFORMAT_STMT FROM @COUNT_TICKLERTABIDCONFIGURATIONSQLFORMAT;
	EXECUTE COUNT_TICKLERTABIDCONFIGURATIONSQLFORMAT_STMT;
	SET @COUNT_SPLITINGTICKLER_TABID=(SELECT CONCAT('SELECT COUNT(*) INTO @COUNT_SPLITING_TICKLER_TABID FROM ',DESTINATIONSCHEMA,'.TICKLER_TABID_PROFILE'));
	PREPARE COUNT_SPLITINGTICKLER_TABID_STMT FROM @COUNT_SPLITINGTICKLER_TABID;
	EXECUTE COUNT_SPLITINGTICKLER_TABID_STMT;
	SET @REJECTION_COUNT=(@COUNT_TICKLER_TABID_CONFIGURATION_SQL_FORMAT-@COUNT_SPLITING_TICKLER_TABID);
	SET @POSTAPID= (SELECT POSTAP_ID FROM POST_AUDIT_PROFILE WHERE POSTAP_DATA='TICKLER_TABID_PROFILE');
	SET @PREASPID = (SELECT PREASP_ID FROM PRE_AUDIT_SUB_PROFILE WHERE PREASP_DATA='TICKLER_TABID_PROFILE');
	SET @PREAMPID = (SELECT PREAMP_ID FROM PRE_AUDIT_MAIN_PROFILE WHERE PREAMP_DATA='CONFIGURATION');
	SET @DUR=DURATION;
	UPDATE PRE_AUDIT_SUB_PROFILE SET PREASP_NO_OF_REC=@COUNT_TICKLER_TABID_CONFIGURATION_SQL_FORMAT WHERE PREASP_DATA='TICKLER_TABID_PROFILE';    
	INSERT INTO POST_AUDIT_HISTORY(POSTAP_ID,POSTAH_NO_OF_REC,PREASP_ID,PREAMP_ID,POSTAH_DURATION,POSTAH_NO_OF_REJ,ULD_ID)VALUES
	(@POSTAPID,@COUNT_SPLITING_TICKLER_TABID,@PREASPID,@PREAMPID,@DUR,@REJECTION_COUNT,@ULDID);
	SET START_TIME = (SELECT CURTIME());
	SET @TRUNCATE_CONFIGURATION_PROFILE=(SELECT CONCAT('TRUNCATE ',DESTINATIONSCHEMA,'.CONFIGURATION_PROFILE'));
	PREPARE TRUNCATE_CONFIGURATION_PROFILE_STMT FROM @TRUNCATE_CONFIGURATION_PROFILE;
	EXECUTE TRUNCATE_CONFIGURATION_PROFILE_STMT;
	SET @INSERT_CONFIGURATION_PROFILE=(SELECT CONCAT('INSERT INTO ',DESTINATIONSCHEMA,'.CONFIGURATION_PROFILE(CNP_DATA) SELECT CNP_DATA FROM ',DESTINATIONSCHEMA,'.TEMP_CONFIG_SQL_FORMAT WHERE CNP_DATA IS NOT NULL AND CNP_ID IN (1,2,3,4,5) ORDER BY ID'));
	PREPARE INSERT_CONFIGURATION_PROFILE_STMT FROM @INSERT_CONFIGURATION_PROFILE;
	EXECUTE INSERT_CONFIGURATION_PROFILE_STMT;
	SET @CONFIGPROFILE_MAX_ID = (SELECT CONCAT('SELECT MAX(CNP_ID) INTO @CONFIG_PROFILE_MAX_ID FROM ',DESTINATIONSCHEMA,'.CONFIGURATION_PROFILE'));
	PREPARE CONFIG_PROFILE_MAX_ID_STMT FROM @CONFIGPROFILE_MAX_ID;
	EXECUTE CONFIG_PROFILE_MAX_ID_STMT;
	SET MAX_ID=@CONFIG_PROFILE_MAX_ID;
	IF (MAX_ID IS NOT NULL) THEN    
		SET @ALTER_CONFIGURATION_PROFILE =(SELECT CONCAT('ALTER TABLE ',DESTINATIONSCHEMA,'.CONFIGURATION_PROFILE AUTO_INCREMENT=',MAX_ID));
		PREPARE ALTER_CONFIGURATION_PROFILE_STMT FROM @ALTER_CONFIGURATION_PROFILE;
		EXECUTE ALTER_CONFIGURATION_PROFILE_STMT;
	END IF;
	SET END_TIME = (SELECT CURTIME());
	SET DURATION=(SELECT TIMEDIFF(END_TIME,START_TIME)); 
	SET @COUNT_CONFIGURATION_PROFILESQLFORMAT=(SELECT CONCAT('SELECT COUNT(CNP_DATA) INTO @COUNT_CONFIGURATION_PROFILE_SQL_FORMAT FROM ',DESTINATIONSCHEMA,'.TEMP_CONFIG_SQL_FORMAT WHERE CNP_DATA IS NOT NULL AND CNP_ID IN (1,2,3,4,5)'));
	PREPARE COUNT_CONFIGURATION_PROFILESQLFORMAT_STMT FROM @COUNT_CONFIGURATION_PROFILESQLFORMAT;
	EXECUTE COUNT_CONFIGURATION_PROFILESQLFORMAT_STMT;
	SET @COUNT_SPLITINGCONFIGURATION_PROFILE=(SELECT CONCAT('SELECT COUNT(*) INTO @COUNT_SPLITING_CONFIGURATION_PROFILE FROM ',DESTINATIONSCHEMA,'.CONFIGURATION_PROFILE'));
	PREPARE COUNT_SPLITINGCONFIGURATION_PROFILE_STMT FROM @COUNT_SPLITINGCONFIGURATION_PROFILE;
	EXECUTE COUNT_SPLITINGCONFIGURATION_PROFILE_STMT;
	SET @REJECTION_COUNT=(@COUNT_CONFIGURATION_PROFILE_SQL_FORMAT-@COUNT_SPLITING_CONFIGURATION_PROFILE);
	SET @POSTAPID= (SELECT POSTAP_ID FROM POST_AUDIT_PROFILE WHERE POSTAP_DATA='CONFIGURATION_PROFILE');
	SET @PREASPID = (SELECT PREASP_ID FROM PRE_AUDIT_SUB_PROFILE WHERE PREASP_DATA='CONFIGURATION_PROFILE');
	SET @PREAMPID = (SELECT PREAMP_ID FROM PRE_AUDIT_MAIN_PROFILE WHERE PREAMP_DATA='CONFIGURATION');
	SET @DUR=DURATION;
	UPDATE PRE_AUDIT_SUB_PROFILE SET PREASP_NO_OF_REC=@COUNT_CONFIGURATION_PROFILE_SQL_FORMAT WHERE PREASP_DATA='CONFIGURATION_PROFILE';    
	INSERT INTO POST_AUDIT_HISTORY(POSTAP_ID,POSTAH_NO_OF_REC,PREASP_ID,PREAMP_ID,POSTAH_DURATION,POSTAH_NO_OF_REJ,ULD_ID)VALUES
	(@POSTAPID,@COUNT_SPLITING_CONFIGURATION_PROFILE,@PREASPID,@PREAMPID,@DUR,@REJECTION_COUNT,@ULDID);  
	SET START_TIME = (SELECT CURTIME());
	SET @TRUNCATE_CONFIGURATION=(SELECT CONCAT('TRUNCATE ',DESTINATIONSCHEMA,'.CONFIGURATION'));
	PREPARE TRUNCATE_CONFIGURATION_STMT FROM @TRUNCATE_CONFIGURATION;
	EXECUTE TRUNCATE_CONFIGURATION_STMT;
	SET @INSERT_CONFIGURATION=(SELECT CONCAT('INSERT INTO ',DESTINATIONSCHEMA,'.CONFIGURATION (CNP_ID,CGN_TYPE) (SELECT CNP_ID,CGN_DATA FROM ',DESTINATIONSCHEMA,'.TEMP_CONFIG_SQL_FORMAT WHERE CGN_ID IN (1,2,3,4,5,6,7,8,9,10) AND CGN_DATA IS NOT NULL ORDER BY ID)'));
	PREPARE INSERT_CONFIGURATION_STMT FROM @INSERT_CONFIGURATION;
	EXECUTE INSERT_CONFIGURATION_STMT;
	SET @CONFIGURATION_MAX_ID = (SELECT CONCAT('SELECT MAX(CGN_ID) INTO @CONFIG_MAX_ID FROM ',DESTINATIONSCHEMA,'.CONFIGURATION'));
	PREPARE CONFIGURATION_MAX_ID_STMT FROM @CONFIGURATION_MAX_ID;
	EXECUTE CONFIGURATION_MAX_ID_STMT;
	SET MAX_ID=@CONFIG_MAX_ID;
	IF (MAX_ID IS NOT NULL) THEN    
		SET @ALTER_CONFIGURATION =(SELECT CONCAT('ALTER TABLE ',DESTINATIONSCHEMA,'.CONFIGURATION AUTO_INCREMENT=',MAX_ID));
		PREPARE ALTER_CONFIGURATION_STMT FROM @ALTER_CONFIGURATION;
		EXECUTE ALTER_CONFIGURATION_STMT;
	END IF;
	SET END_TIME = (SELECT CURTIME());
	SET DURATION=(SELECT TIMEDIFF(END_TIME,START_TIME));    
	SET @COUNT_CONFIGURATIONSQLFORMAT=(SELECT CONCAT('SELECT COUNT(CGN_DATA) INTO @COUNT_CONFIGURATION_SQL_FORMAT FROM ',DESTINATIONSCHEMA,'.TEMP_CONFIG_SQL_FORMAT WHERE CGN_DATA IS NOT NULL AND CGN_ID IN (1,2,3,4,5,6,7,8,9,10)'));
	PREPARE COUNT_CONFIGURATIONSQLFORMAT_STMT FROM @COUNT_CONFIGURATIONSQLFORMAT;
	EXECUTE COUNT_CONFIGURATIONSQLFORMAT_STMT;
	SET @COUNT_SPLITINGCONFIGURATION=(SELECT CONCAT('SELECT COUNT(*) INTO @COUNT_SPLITING_CONFIGURATION FROM ',DESTINATIONSCHEMA,'.CONFIGURATION'));
	PREPARE COUNT_SPLITINGCONFIGURATION_STMT FROM @COUNT_SPLITINGCONFIGURATION;
	EXECUTE COUNT_SPLITINGCONFIGURATION_STMT;
	SET @REJECTION_COUNT=(@COUNT_CONFIGURATION_SQL_FORMAT-@COUNT_SPLITING_CONFIGURATION);
	SET @POSTAPID= (SELECT POSTAP_ID FROM POST_AUDIT_PROFILE WHERE POSTAP_DATA='CONFIGURATION');
	SET @PREASPID = (SELECT PREASP_ID FROM PRE_AUDIT_SUB_PROFILE WHERE PREASP_DATA='CONFIGURATION');
	SET @PREAMPID = (SELECT PREAMP_ID FROM PRE_AUDIT_MAIN_PROFILE WHERE PREAMP_DATA='CONFIGURATION');
	SET @DUR=DURATION;
	UPDATE PRE_AUDIT_SUB_PROFILE SET PREASP_NO_OF_REC=@COUNT_CONFIGURATION_SQL_FORMAT WHERE PREASP_DATA='CONFIGURATION';    
	INSERT INTO POST_AUDIT_HISTORY(POSTAP_ID,POSTAH_NO_OF_REC,PREASP_ID,PREAMP_ID,POSTAH_DURATION,POSTAH_NO_OF_REJ,ULD_ID)VALUES
	(@POSTAPID,@COUNT_SPLITING_CONFIGURATION,@PREASPID,@PREAMPID,@DUR,@REJECTION_COUNT,@ULDID); 
	SET START_TIME = (SELECT CURTIME());
	SET @TRUNCATE_ERROR_MESSAGE_CONFIGURATION=(SELECT CONCAT('TRUNCATE ',DESTINATIONSCHEMA,'.ERROR_MESSAGE_CONFIGURATION'));
	PREPARE TRUNCATE_ERROR_MESSAGE_CONFIGURATION_STMT FROM @TRUNCATE_ERROR_MESSAGE_CONFIGURATION;
	EXECUTE TRUNCATE_ERROR_MESSAGE_CONFIGURATION_STMT;
	SET @INSERT_ERROR_MESSAGE_CONFIGURATION=(SELECT CONCAT('INSERT INTO ',DESTINATIONSCHEMA,'.ERROR_MESSAGE_CONFIGURATION(CNP_ID,EMC_CODE,EMC_DATA,ULD_ID,EMC_TIMESTAMP)
	(SELECT CSQL.CNP_ID,CSQL.EMC_CODE,CSQL.EMC_DATA,ULD.ULD_ID,CSQL.TIMESTAMP FROM ',DESTINATIONSCHEMA,'.TEMP_CONFIG_SQL_FORMAT CSQL,',DESTINATIONSCHEMA,'.USER_LOGIN_DETAILS ULD WHERE ULD.ULD_LOGINID=CSQL.USER_STAMP AND CSQL.EMC_DATA IS NOT NULL ORDER BY CSQL.ID)'));
	PREPARE INSERT_ERROR_MESSAGE_CONFIGURATION_STMT FROM @INSERT_ERROR_MESSAGE_CONFIGURATION;
	EXECUTE INSERT_ERROR_MESSAGE_CONFIGURATION_STMT;
	SET @ERRORMESSAGECONFIGURATION_MAX_ID = (SELECT CONCAT('SELECT MAX(EMC_ID) INTO @ERROR_MESSAGE_CONFIGURATION_MAX_ID FROM ',DESTINATIONSCHEMA,'.ERROR_MESSAGE_CONFIGURATION'));
	PREPARE ERROR_MESSAGE_CONFIGURATION_MAX_ID_STMT FROM @ERRORMESSAGECONFIGURATION_MAX_ID;
	EXECUTE ERROR_MESSAGE_CONFIGURATION_MAX_ID_STMT;
	SET MAX_ID=@ERROR_MESSAGE_CONFIGURATION_MAX_ID;
	IF (MAX_ID IS NOT NULL) THEN    
		SET @ALTER_ERROR_MESSAGE_CONFIGURATION =(SELECT CONCAT('ALTER TABLE ',DESTINATIONSCHEMA,'.ERROR_MESSAGE_CONFIGURATION AUTO_INCREMENT=',MAX_ID));
		PREPARE ALTER_ERROR_MESSAGE_CONFIGURATION_STMT FROM @ALTER_ERROR_MESSAGE_CONFIGURATION;
		EXECUTE ALTER_ERROR_MESSAGE_CONFIGURATION_STMT;
	END IF;
	SET END_TIME = (SELECT CURTIME());
	SET DURATION=(SELECT TIMEDIFF(END_TIME,START_TIME));
	SET @COUNTERRORMESSAGECONFIGURATION_SQL_FORMAT=(SELECT CONCAT('SELECT COUNT(EMC_DATA) INTO @COUNT_ERROR_MESSAGE_CONFIGURATION_SQL_FORMAT FROM ',DESTINATIONSCHEMA,'.TEMP_CONFIG_SQL_FORMAT CSQL  WHERE CSQL.EMC_DATA IS NOT NULL'));
	PREPARE COUNTERRORMESSAGECONFIGURATION_SQL_FORMAT_STMT FROM @COUNTERRORMESSAGECONFIGURATION_SQL_FORMAT;
	EXECUTE COUNTERRORMESSAGECONFIGURATION_SQL_FORMAT_STMT;
	SET @COUNT_SPLITING_ERRORMESSAGECONFIGURATION=(SELECT CONCAT('SELECT COUNT(*) INTO @COUNT_SPLITING_ERROR_MESSAGE_CONFIGURATION FROM ',DESTINATIONSCHEMA,'.ERROR_MESSAGE_CONFIGURATION'));
	PREPARE COUNT_SPLITING_ERRORMESSAGECONFIGURATION_STMT FROM @COUNT_SPLITING_ERRORMESSAGECONFIGURATION;
	EXECUTE COUNT_SPLITING_ERRORMESSAGECONFIGURATION_STMT;
	SET @REJECTION_COUNT=(@COUNT_ERROR_MESSAGE_CONFIGURATION_SQL_FORMAT-@COUNT_SPLITING_ERROR_MESSAGE_CONFIGURATION);
	SET @POSTAPID= (SELECT POSTAP_ID FROM POST_AUDIT_PROFILE WHERE POSTAP_DATA='ERROR_MESSAGE_CONFIGURATION');
	SET @PREASPID = (SELECT PREASP_ID FROM PRE_AUDIT_SUB_PROFILE WHERE PREASP_DATA='ERROR_MESSAGE_CONFIGURATION');
	SET @PREAMPID = (SELECT PREAMP_ID FROM PRE_AUDIT_MAIN_PROFILE WHERE PREAMP_DATA='CONFIGURATION');
	SET @DUR=DURATION;
	UPDATE PRE_AUDIT_SUB_PROFILE SET PREASP_NO_OF_REC=@COUNT_ERROR_MESSAGE_CONFIGURATION_SQL_FORMAT WHERE PREASP_DATA='ERROR_MESSAGE_CONFIGURATION';    
	INSERT INTO POST_AUDIT_HISTORY(POSTAP_ID,POSTAH_NO_OF_REC,PREASP_ID,PREAMP_ID,POSTAH_DURATION,POSTAH_NO_OF_REJ,ULD_ID)VALUES
	(@POSTAPID,@COUNT_SPLITING_ERROR_MESSAGE_CONFIGURATION,@PREASPID,@PREAMPID,@DUR,@REJECTION_COUNT,@ULDID);
	SET FOREIGN_KEY_CHECKS=1;
	COMMIT;
END;
