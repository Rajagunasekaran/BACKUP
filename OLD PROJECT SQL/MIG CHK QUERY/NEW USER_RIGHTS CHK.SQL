-- MENU PROFILE

SELECT * FROM MENU_PROFILE;

SELECT EP_ID, FP_ID, MP_MNAME, MP_MSUB, MP_MSUBMENU, MP_MFILENAME 
FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT 
WHERE MP_MNAME IS NOT NULL AND MP_MFILENAME IS NOT NULL;

--

SELECT EP_ID, FP_ID, MP_MNAME, MP_MSUB , MP_MSUBMENU, MP_MFILENAME FROM MENU_PROFILE;

SELECT EP_ID, FP_ID, MP_MNAME, MP_MSUB , MP_MSUBMENU, MP_MFILENAME 
FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT WHERE MP_MNAME IS NOT NULL AND MP_MFILENAME IS NOT NULL;

SELECT DISTINCT MP.EP_ID, MP.FP_ID,  MP.MP_MNAME,MP.MP_MSUB,MP.MP_MSUBMENU,MP.MP_MFILENAME
FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT URSF
LEFT JOIN MENU_PROFILE MP ON URSF.MP_MFILENAME = MP.MP_MFILENAME OR URSF.MP_MNAME = MP.MP_MNAME OR URSF.MP_MSUB = MP.MP_MSUB OR URSF.MP_MSUBMENU = MP.MP_MSUBMENU
WHERE URSF.MP_MNAME IS NOT NULL AND URSF.MP_MFILENAME IS NOT NULL ORDER BY MP.MP_ID ;

-- ROLE CREATION

SELECT * FROM ROLE_CREATION;

SELECT DISTINCT ROLES,RACESS,USERSTAMP,TIMESTAMP 
FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT 
WHERE ROLES IS NOT NULL GROUP BY ROLES;

--

SELECT TIMESTAMP FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT WHERE ROLES IS NOT NULL  GROUP BY ROLES;

SELECT ADDTIME(RC_TIMESTAMP,'8:00')FROM ROLE_CREATION;

SELECT URSF.TIMESTAMP,ADDTIME(RC.RC_TIMESTAMP,'8:00')
FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT URSF, ROLE_CREATION RC
WHERE URSF.ROLES IS NOT NULL AND ADDTIME(RC.RC_TIMESTAMP,'8:00')=URSF.TIMESTAMP GROUP BY URSF.ROLES;

--

SELECT USERSTAMP FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT WHERE ROLES IS NOT NULL  GROUP BY ROLES;

SELECT RC_USERSTAMP FROM ROLE_CREATION;

SELECT A.USERSTAMP,C.RC_USERSTAMP 
FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT A,ROLE_CREATION C 
WHERE A.USERSTAMP=C.RC_USERSTAMP AND A.ROLES IS NOT NULL GROUP BY A.ROLES;

-- FILE_PROFILE

SELECT * FROM FILE_PROFILE;

SELECT FP_FOLDER_ID,FP_FILE_ID,FP_FILE_FLAG FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT WHERE FP_FOLDER_ID IS NOT NULL;

--

SELECT FP_FOLDER_ID FROM FILE_PROFILE;

SELECT FP_FOLDER_ID FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT WHERE FP_FOLDER_ID IS NOT NULL;

SELECT URSF.FP_FOLDER_ID,FP.FP_FOLDER_ID
FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT URSF ,FILE_PROFILE FP 
WHERE  URSF.FP_FOLDER_ID=FP.FP_FOLDER_ID AND URSF.FP_FOLDER_ID IS NOT NULL GROUP BY FP.FP_ID ;

--

SELECT FP_FILE_ID FROM FILE_PROFILE WHERE FP_FILE_ID IS NOT NULL;

SELECT FP_FILE_ID FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT WHERE FP_FILE_ID IS NOT NULL;

SELECT URSF.FP_FILE_ID,FP.FP_FILE_ID
FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT URSF,FILE_PROFILE FP 
WHERE URSF.FP_FILE_ID=FP.FP_FILE_ID AND URSF.FP_FILE_ID IS NOT NULL GROUP BY FP.FP_ID ;

-- USER_LOGIN_DETAILS

SELECT * FROM USER_LOGIN_DETAILS;

SELECT DISTINCT(UNAME),USERSTAMP,TIMESTAMP
FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT 
WHERE UNAME IS NOT NULL ORDER BY UNAME ASC;

--

SELECT TIMESTAMP FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT WHERE UNAME IS NOT NULL  GROUP BY UNAME;

SELECT ADDTIME(ULD_TIMESTAMP,'8:00')FROM USER_LOGIN_DETAILS;

SELECT URSF.TIMESTAMP,ADDTIME(ULD.ULD_TIMESTAMP,'8:00') 
FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT URSF,USER_LOGIN_DETAILS ULD
WHERE ADDTIME(ULD.ULD_TIMESTAMP,'8:00')= URSF.TIMESTAMP AND URSF.UNAME IS NOT NULL  GROUP BY URSF.UNAME;

--

SELECT USERSTAMP FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT WHERE UNAME IS NOT NULL  GROUP BY UNAME;

SELECT ULD_USERSTAMP FROM USER_LOGIN_DETAILS;

SELECT DISTINCT(A.UNAME),A.USERSTAMP,C.ULD_USERSTAMP
FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT A,USER_LOGIN_DETAILS C
WHERE A.USERSTAMP=C.ULD_USERSTAMP AND A.UNAME IS NOT NULL ORDER BY UNAME ASC;

-- USER_ACCESS

SELECT * FROM USER_ACCESS;

SELECT UNAME,URECVER,UJOIN,UTERMINATE,UJDATE,UEDATE,UREASON,USERSTAMP,URROLES,TIMESTAMP
FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT 
WHERE UNAME IS NOT NULL;

-- 

SELECT DISTINCT UA_END_DATE FROM USER_ACCESS WHERE UA_END_DATE IS NOT NULL;

SELECT DISTINCT UEDATE FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT WHERE UEDATE IS NOT NULL;

SELECT DISTINCT  US.UEDATE,UA.UA_END_DATE 
FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT US , USER_ACCESS UA 
WHERE US.UEDATE=UA.UA_END_DATE;

--

SELECT DISTINCT UA_JOIN_DATE FROM USER_ACCESS WHERE UA_JOIN_DATE IS NOT NULL;

SELECT DISTINCT UJDATE FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT WHERE UJDATE IS NOT NULL;

SELECT DISTINCT  US.UJDATE,UA.UA_JOIN_DATE 
FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT US , USER_ACCESS UA 
WHERE US.UJDATE=UA.UA_JOIN_DATE;

--

SELECT TIMESTAMP FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT WHERE UNAME IS NOT NULL;

SELECT ADDTIME(UA_TIMESTAMP,'8:00')FROM USER_ACCESS;

SELECT URSF.TIMESTAMP,ADDTIME(UA.UA_TIMESTAMP,'8:00') 
FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT URSF,USER_ACCESS UA
WHERE ADDTIME(UA.UA_TIMESTAMP,'8:00')= URSF.TIMESTAMP AND URSF.UNAME IS NOT NULL  GROUP BY URSF.UNAME;

--

SELECT USERSTAMP FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT WHERE UNAME IS NOT NULL  GROUP BY UNAME;

SELECT UA_USERSTAMP FROM USER_ACCESS;

SELECT DISTINCT(A.UNAME),A.USERSTAMP,C.UA_USERSTAMP
FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT A,USER_ACCESS C 
WHERE A.USERSTAMP=C.UA_USERSTAMP AND A.UNAME IS NOT NULL;

-- BASIC_ROLE_PROFILE

SELECT * FROM BASIC_ROLE_PROFILE;

SELECT URSF.URC_ID, URSF.BRP_BR_ID, ULD.ULD_ID ,URSF.TIMESTAMP
FROM USER_LOGIN_DETAILS ULD , SOURCE_16072014.USER_RIGHTS_SQL_FORMAT URSF 
WHERE ULD.ULD_LOGINID=URSF.USERSTAMP AND URSF.URC_ID IS NOT NULL AND URSF.BRP_BR_ID IS NOT NULL AND URSF.USERSTAMP IS NOT NULL;

--

SELECT BRP_TIMESTAMP FROM BASIC_ROLE_PROFILE;

SELECT TIMESTAMP FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT URSF 
WHERE URSF.URC_ID IS NOT NULL AND URSF.BRP_BR_ID IS NOT NULL AND URSF.USERSTAMP IS NOT NULL;

SELECT URSF.TIMESTAMP,BRP.BRP_TIMESTAMP
FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT URSF , BASIC_ROLE_PROFILE BRP
WHERE URSF.TIMESTAMP=BRP.BRP_TIMESTAMP AND URSF.URC_ID IS NOT NULL AND URSF.BRP_BR_ID IS NOT NULL AND URSF.USERSTAMP IS NOT NULL GROUP BY BRP.BRP_ID;

--

SELECT DISTINCT ULD_ID FROM BASIC_ROLE_PROFILE;

SELECT DISTINCT USERSTAMP FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT URSF 
WHERE URSF.URC_ID IS NOT NULL AND URSF.BRP_BR_ID IS NOT NULL AND URSF.USERSTAMP IS NOT NULL;

SELECT DISTINCT A.USERSTAMP,B.ULD_LOGINID,B.ULD_ID,C.ULD_ID 
FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT A 
INNER JOIN USER_LOGIN_DETAILS B ON A.USERSTAMP= B.ULD_LOGINID 
INNER JOIN BASIC_ROLE_PROFILE C ON B.ULD_ID=C.ULD_ID;

-- BASIC_MENU_PROFILE

SELECT * FROM BASIC_MENU_PROFILE;

SELECT URSF.URC_ID,URSF.MP_ID,ULD.ULD_ID,URSF.TIMESTAMP 
FROM USER_LOGIN_DETAILS ULD,SOURCE_16072014.USER_RIGHTS_SQL_FORMAT URSF 
WHERE ULD.ULD_LOGINID=URSF.USERSTAMP AND URC_ID IS NOT NULL AND MP_ID IS NOT NULL AND USERSTAMP IS NOT NULL;

--

SELECT BMP_TIMESTAMP FROM BASIC_MENU_PROFILE;

SELECT TIMESTAMP FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT URSF 
WHERE URSF.URC_ID IS NOT NULL AND URSF.MP_ID IS NOT NULL AND URSF.USERSTAMP IS NOT NULL;

SELECT URSF.TIMESTAMP,BMP.BMP_TIMESTAMP
FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT URSF , BASIC_MENU_PROFILE BMP
WHERE URSF.TIMESTAMP=BMP.BMP_TIMESTAMP AND URSF.URC_ID IS NOT NULL AND URSF.MP_ID IS NOT NULL AND URSF.USERSTAMP IS NOT NULL GROUP BY BMP.BMP_ID;

--

SELECT DISTINCT ULD_ID FROM BASIC_MENU_PROFILE;

SELECT DISTINCT USERSTAMP FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT URSF 
WHERE URSF.URC_ID IS NOT NULL AND URSF.MP_ID IS NOT NULL AND URSF.USERSTAMP IS NOT NULL;

SELECT DISTINCT A.USERSTAMP,B.ULD_LOGINID,B.ULD_ID,C.ULD_ID 
FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT A 
INNER JOIN USER_LOGIN_DETAILS B ON A.USERSTAMP= B.ULD_LOGINID
INNER JOIN BASIC_MENU_PROFILE C ON B.ULD_ID=C.ULD_ID;

-- PUBLIC_HOLIDAY

SELECT * FROM PUBLIC_HOLIDAY;

SELECT PH_DESCRIPTION,PH_DATE 
FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT
WHERE PH_DESCRIPTION IS NOT NULL AND PH_DATE IS NOT NULL;

--

SELECT PH.PH_DESCRIPTION,PH.PH_DATE 
FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT URSF,PUBLIC_HOLIDAY PH
WHERE URSF.PH_DESCRIPTION IS NOT NULL AND URSF.PH_DATE IS NOT NULL AND URSF.PH_DESCRIPTION=PH.PH_DESCRIPTION AND URSF.PH_DATE=PH.PH_DATE;

-- STORED_PROCEDURE_PROFILE

SELECT * FROM STORED_PROCEDURE_PROFILE;

SELECT SPP_NAME FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT WHERE SPP_NAME IS NOT NULL;

-- 

SELECT SPP.SPP_NAME,URSF.SPP_NAME
FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT URSF,STORED_PROCEDURE_PROFILE SPP
WHERE URSF.SPP_NAME IS NOT NULL AND URSF.SPP_NAME= SPP.SPP_NAME ;

-- VIEW_PROFILE

SELECT * FROM VIEW_PROFILE;

SELECT VP_NAME FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT WHERE VP_NAME IS NOT NULL;

--

SELECT VP.VP_NAME, URSF.VP_NAME
FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT URSF,VIEW_PROFILE VP
WHERE URSF.VP_NAME IS NOT NULL AND URSF.VP_NAME= VP.VP_NAME GROUP BY VP.VP_ID;

-- PLATFORM_MANAGEMENT

SELECT * FROM PLATFORM_MANAGEMENT;	

SELECT MP_ID,POSTAP_ID,SPP_ID,VP_ID 
FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT
WHERE MP_ID IS NOT NULL AND PM_ID IS NOT NULL;

--

SELECT MP_ID FROM PLATFORM_MANAGEMENT;	

SELECT MP_ID FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT WHERE MP_ID IS NOT NULL AND PM_ID IS NOT NULL;

SELECT URSF.MP_ID,PM.MP_ID FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT URSF,PLATFORM_MANAGEMENT PM
WHERE URSF.MP_ID=PM.MP_ID  AND URSF.MP_ID IS NOT NULL AND URSF.PM_ID IS NOT NULL GROUP BY PM.PM_ID;

--

SELECT POSTAP_ID FROM PLATFORM_MANAGEMENT WHERE POSTAP_ID IS NOT NULL;	

SELECT POSTAP_ID FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT WHERE MP_ID IS NOT NULL AND PM_ID IS NOT NULL AND POSTAP_ID IS NOT NULL;	;

SELECT URSF.POSTAP_ID,PM.POSTAP_ID 
FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT URSF,PLATFORM_MANAGEMENT PM
WHERE URSF.POSTAP_ID=PM.POSTAP_ID AND URSF.MP_ID IS NOT NULL AND URSF.PM_ID IS NOT NULL GROUP BY PM.PM_ID;

--

SELECT SPP_ID FROM PLATFORM_MANAGEMENT WHERE SPP_ID IS NOT NULL;	

SELECT SPP_ID FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT WHERE MP_ID IS NOT NULL AND PM_ID IS NOT NULL AND SPP_ID IS NOT NULL;	;

SELECT URSF.SPP_ID,PM.SPP_ID FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT URSF,PLATFORM_MANAGEMENT PM
WHERE URSF.SPP_ID=PM.SPP_ID  AND URSF.MP_ID IS NOT NULL AND URSF.PM_ID IS NOT NULL GROUP BY PM.PM_ID;

--

SELECT VP_ID FROM PLATFORM_MANAGEMENT WHERE VP_ID IS NOT NULL;	

SELECT VP_ID FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT WHERE MP_ID IS NOT NULL AND PM_ID IS NOT NULL AND VP_ID IS NOT NULL;

SELECT URSF.VP_ID,PM.VP_ID FROM SOURCE_16072014.USER_RIGHTS_SQL_FORMAT URSF,PLATFORM_MANAGEMENT PM
WHERE URSF.VP_ID=PM.VP_ID  AND URSF.MP_ID IS NOT NULL AND URSF.PM_ID IS NOT NULL GROUP BY PM.PM_ID;

-- USER_MENU_DETAILS

SELECT * FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT WHERE MROLES='ADMIN';
SELECT * FROM USER_MENU_DETAILS WHERE RC_ID=1;

SELECT * FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT WHERE MROLES='SUPER ADMIN';
SELECT * FROM USER_MENU_DETAILS WHERE RC_ID=2; -- EXTRA MENU IN SQL TABLE

SELECT * FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT WHERE MROLES='USER';
SELECT * FROM USER_MENU_DETAILS WHERE RC_ID=3;

SELECT * FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT WHERE MROLES='USER1';
SELECT * FROM USER_MENU_DETAILS WHERE RC_ID=4;

--

SELECT TIMESTAMP FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT URSF WHERE MROLES='ADMIN';
SELECT ADDTIME(MD_TIMESTAMP,'8:00') FROM USER_MENU_DETAILS WHERE RC_ID=1;

SELECT TIMESTAMP FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT URSF WHERE MROLES='SUPER ADMIN' AND TIMESTAMP IS NOT NULL; -- 73
SELECT ADDTIME(MD_TIMESTAMP,'8:00') FROM USER_MENU_DETAILS WHERE RC_ID=2; -- 82 (EXTRA MENU IN SQL TABLE)

SELECT TIMESTAMP FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT URSF WHERE MROLES='USER';
SELECT ADDTIME(MD_TIMESTAMP,'8:00') FROM USER_MENU_DETAILS WHERE RC_ID=3;

SELECT TIMESTAMP FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT URSF WHERE MROLES='USER1';
SELECT ADDTIME(MD_TIMESTAMP,'8:00') FROM USER_MENU_DETAILS WHERE RC_ID=4;

--

SELECT DISTINCT ULD_ID FROM USER_MENU_DETAILS;

SELECT DISTINCT USERSTAMP FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT WHERE MROLES='ADMIN' OR MROLES='USER' OR MROLES='USER1';

SELECT DISTINCT A.USERSTAMP,B.ULD_LOGINID,B.ULD_ID,C.ULD_ID 
FROM SOURCE_16072014.USER_RIGHTS_SCDB_FORMAT A
INNER JOIN USER_LOGIN_DETAILS B ON A.USERSTAMP= B.ULD_LOGINID
INNER JOIN USER_MENU_DETAILS C ON B.ULD_ID=C.ULD_ID AND (A.MROLES='ADMIN' OR A.MROLES='USER' OR A.MROLES='USER1');

-- USER_FILE_DETAILS

SELECT * FROM USER_FILE_DETAILS; -- 23 DATA'S
